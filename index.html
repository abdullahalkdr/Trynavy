<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NAVY - Men's Fashion</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'Barlow',sans-serif; background:#f4f4f4; }

    .menu-title{font-weight:bold;}
    .submenu a{font-weight:normal;}
    .submenu{display:none; padding-left:20px;}
    .arrow{font-size:16px; transition:.3s}
    .arrow.rotate{transform:rotate(180deg)}

    /* Header */
    .navbar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#fff;border-bottom:1px solid #ddd;position:relative}
    .navbar img.logo{height:60px}
    .nav-left,.nav-right{display:flex;align-items:center;gap:16px}
    .nav-icon{font-size:20px;color:#001f3f;cursor:pointer}
    .cart-count{background:red;color:#fff;font-size:11px;border-radius:50%;padding:2px 6px;position:absolute;top:2px;right:-6px}

    /* App sidebar (menu) */
    .sidebar{height:100%;width:0;position:fixed;top:0;left:0;z-index:1000;background:#fff;overflow-x:hidden;transition:.3s;padding-top:60px;color:#001f3f;border-top-right-radius:25px;border-bottom-right-radius:25px}
    .sidebar a{color:#001f3f;padding:12px 20px;text-decoration:none;display:block;font-size:18px;transition:.3s;font-weight:normal}
    .sidebar .closebtn{position:absolute;top:20px;right:25px;font-size:30px}
    .menu-item{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;cursor:pointer;color:#001f3f;font-size:18px}
    .submenu{display:none;flex-direction:column;padding-left:30px;background:#fff}
    .arrow-icon{font-size:12px;margin-left:30px;transition:.3s}
    .arrow-icon.rotate{transform:rotate(180deg)}

    .tagline{text-align:center;color:#001f3f;font-weight:500;margin:12px 0 24px}

    /* ====== Shop layout like Hollister ====== */
    .shop{max-width:1200px;margin:0 auto;padding:0 16px 40px;display:grid;grid-template-columns:1fr;gap:24px}
    @media (min-width: 992px){
      .shop{grid-template-columns:260px 1fr;}
    }

/* ====== Filters: Hollister-like ====== */
.filters{
  background: #f8f6f3;           /* نفس لون الخلفية عندهم */
  border-radius: 12px;
  padding: 16px 18px;
  box-shadow: 0 2px 5px rgba(0,0,0,.05);
  color:#2c2c2c;
}

.filters h3{
  margin: 0 0 8px;
  font-size: 16px;
  font-weight: 700;
  color:#2c2c2c;
}

/* كل قسم */
.facet{
  padding: 12px 0;
  border-top: 1px solid #e7e3dc; /* فاصل رفيع مثل الصورة */
}
.facet:first-of-type{ border-top: 0; }

/* زر الأكورديون */
.facet-btn{
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: none;
  border: 0;
  padding: 6px 0 8px;
  font-size: 15px;
  font-weight: 600;
  color: #2c2c2c;
  cursor: pointer;
}
.facet-btn i{ font-size: 14px; }

/* محتوى الخيارات */
.facet-content{
  display: none;   /* <-- المهم */
  padding-top: 6px;
}

/* العناوين الفرعية (Tops / Bottoms / Other) */
.facet-content strong{
  display: block;
  margin: 10px 0 6px;
  font-size: 14px;
  color:#2c2c2c;
}

/* كل خيار سطر لحاله */
.facet-content label{
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 2px;
  font-size: 14px;
  color:#2c2c2c;
  user-select: none;
}

/* ستايل صندوق التحديد نفس هولستر */
.facet-content input[type="checkbox"]{
  appearance: none;
  -webkit-appearance: none;
  width: 22px;
  height: 22px;
  border: 2px solid #2c2c2c;      /* لون الإطار الداكن */
  border-radius: 6px;              /* زوايا ناعمة */
  background: #fff;
  display: inline-block;
  position: relative;
  flex-shrink: 0;
}

.facet-content input[type="checkbox"]:checked{
  background: #2c2c2c;            /* يمتلئ داكن عند التحديد */
  border-color: #2c2c2c;
}

.facet-content input[type="checkbox"]:checked::after{
  content: "";
  position: absolute;
  left: 6px; top: 2px;
  width: 6px; height: 12px;
  border: solid #fff;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* مسافات جانبية لطيفة */
.filters .facet-content label + label{ margin-top: 2px; }

/* موبايل: تصغير خفيف */
@media (max-width: 768px){
  .facet-content label{ padding: 6px 2px; font-size: 13.5px; }
  .facet-content input[type="checkbox"]{ width: 20px; height: 20px; }
}

    /* Sort row */
    .sort-row{display:flex;justify-content:flex-end;align-items:center;gap:8px;margin-bottom:8px}
    .sort-row select{padding:8px 10px;border:1px solid #ddd;border-radius:8px;background:#fff}

    /* Product grid */
    .grid{display:grid;grid-template-columns:1fr;gap:20px}
    @media (min-width: 700px){ .grid{grid-template-columns:repeat(2,1fr);} }
    @media (min-width: 992px){ .grid{grid-template-columns:repeat(3,1fr);} }

    /* Promo card spans like Hollister */
    .promo{position:relative;overflow:hidden;border-radius:12px;background:#fff;box-shadow:0 2px 5px rgba(0,0,0,.05)}
    .promo img{width:100%;display:block}
    .promo .promo-text{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;text-align:center;color:#fff;font-weight:700;font-size:28px;letter-spacing:.3px;text-shadow:0 2px 8px rgba(0,0,0,.35)}
    @media (min-width: 992px){ .promo{grid-column:span 1;} }
    /* لو تبيها أعرض: خليها span 2 */
    @media (min-width: 1200px){ .promo{grid-column:span 1;} }

    /* Product card */
    .product{background:#fff;padding:12px;border-radius:12px;box-shadow:0 2px 5px rgba(0,0,0,.05);position:relative}
    .product .wish{position:absolute;top:10px;right:10px;width:32px;height:32px;border-radius:50%;display:grid;place-items:center;background:rgba(255,255,255,.9);border:1px solid #eee}
    .product img{width:100%;border-radius:10px;display:block}
    .product h2{font-size:16px;color:#111;margin:10px 0 6px}
    .price{color:#001f3f;font-weight:700;margin-bottom:8px}
    .swatches{display:flex;gap:6px;align-items:center;margin:8px 0}
    .swatch{width:16px;height:16px;border-radius:50%;border:1px solid #ccc;background:#ddd}
    .swatch.more{border:none;width:auto;height:auto;font-size:12px;color:#666}

    footer{text-align:center;font-size:14px;color:#777;margin:40px 0 20px}
    /* ====== Category Circles Row ====== */
.cat-row {
  max-width: 1200px;
  margin: 0 auto 10px;
  padding: 0 16px;
  display: flex;
  justify-content: flex-start; /* يبدأ من أول الجهة */
  gap: 24px;
  overflow-x: auto;
  scrollbar-width: none;
  direction: rtl; /* يخلي أول عنصر من اليمين */
}
.cat-row::-webkit-scrollbar { display: none; }

.cat {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-decoration: none;
  color: #111;
  min-width: 110px;
}

.cat .thumb {
  width: 110px;
  height: 110px;
  border-radius: 50%;
  overflow: hidden;
  border: 1px solid #ddd;
  display: block;
  background: #fff;
}

.cat .thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.cat .label {
  margin-top: 10px;
  font-size: 14px;
  font-weight: 400; /* مو bold */
  text-align: center;
  color: #2c2c2c;
  line-height: 1.2;
}



/* تأثير hover مثل هولستر */
.cat:hover .thumb{
  transform: translateY(-2px) scale(1.03);
  box-shadow: 0 6px 14px rgba(0,0,0,.12);
}

/* محاذاة عربية إن رغبت */
html[dir="rtl"] .cat-row{ direction: rtl; }
/* تصغير نص الخيارات داخل الفلتر */
.filters .facet-content label{
  font-size: 13px;       /* غيّرها 12/13/14 حسب مزاجك */
  gap: 8px;              /* مسافة أصغر بين المربع والنص */
  padding: 6px 2px;
}

/* تصغير حجم المربع نفسه */
.filters .facet-content input[type="checkbox"]{
  width: 18px;           /* كان 22px */
  height: 18px;
  border-radius: 6px;
}

/* تصغير علامة الصح داخل المربع بدقة */
.filters .facet-content input[type="checkbox"]:checked::after{
  left: 5px;             /* كان 6px */
  top: 3px;              /* كان 2px */
  width: 5px;            /* كان 6px */
  height: 9px;           /* كان 12px */
  border-width: 0 2px 2px 0; /* نحافة الصح */
}

/* لو حسّيت إن القاعدة القديمة تغلبها، فعّل !important */

/* الفلتر يسوي سكرول بروحه */
.filters{
  max-height: calc(100vh - 140px);
  overflow-y: auto;
}

/* يجعل الفلتر ثابت أعلى الصفحة أثناء السكول */
@media (min-width: 992px){
  .filter-scroll{
    position: sticky;
    top: 90px; /* عدّلها إذا ارتفاع الهيدر مختلف */
  }
}

/* شريط تمرير أنيق */
.filter-scroll::-webkit-scrollbar{ width: 6px; }
.filter-scroll::-webkit-scrollbar-thumb{ background: rgba(0,0,0,.2); border-radius: 3px; }

/* بالموبايل خلِّه طبيعي بدون سكرول داخلي */
@media (max-width: 991px){
  .filter-scroll{ max-height: none; overflow: visible; position: static; }
}

/* ===== PDP (Hollister-like) ===== */
.pdp-overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;z-index:1100}
.pdp{position:fixed;right:-100%;top:0;height:100vh;width:100%;max-width:980px;background:#fff;z-index:1101;transition:right .32s ease;border-top-left-radius:24px;border-bottom-left-radius:24px;overflow-y:auto}
@media (max-width:768px){ .pdp{max-width:100%} }
.pdp-hd{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid #e7e3dc;position:sticky;top:0;background:#fff;z-index:2}
.pdp-body{display:grid;grid-template-columns:1fr 1fr;gap:22px;padding:18px}
@media (max-width:992px){ .pdp-body{grid-template-columns:1fr} }
.pdp-gallery{display:grid;gap:10px}
.pdp-gallery img{width:100%;border-radius:10px;display:block}
.pdp-title{font-size:20px;font-weight:800;margin:0 0 6px;color:#111}
.pdp-price{font-weight:800;color:#001f3f;margin:6px 0 16px}
.section-hd{font-weight:700;margin:12px 0 6px}
.color-row,.size-row{display:flex;gap:10px;flex-wrap:wrap}
.swatch-lg{width:28px;height:28px;border-radius:50%;border:1px solid #d5d5d5;cursor:pointer;position:relative;outline:none}
.swatch-lg.active{box-shadow:0 0 0 2px #001f3f inset;border-color:#001f3f}
.size-chip{min-width:38px;height:38px;border:1px solid #d7d7d7;border-radius:999px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-weight:700;background:#fff}
.size-chip.disabled{opacity:.4;cursor:not-allowed;text-decoration:line-through}
.size-chip.active{border-color:#001f3f;box-shadow:0 0 0 2px #001f3f inset}
.pdp-actions{display:flex;gap:10px;margin-top:16px}
.btn-pill{flex:1;padding:12px 14px;border:none;border-radius:999px;font-weight:800;cursor:pointer}
.btn-primary{background:#001f3f;color:#fff}
.btn-ghost{background:#fff;border:1px solid #e7e3dc;color:#111}
.pdp-meta{margin-top:14px;border-top:1px solid #e7e3dc}
.meta-item{padding:14px 0;border-bottom:1px solid #e7e3dc;display:flex;justify-content:space-between;align-items:center;font-weight:600;color:#2c2c2c}
.meta-item i{font-size:12px;color:#6b6b6b}
.badge{display:inline-flex;align-items:center;gap:8px;padding:10px;border:1px solid #e7e3dc;border-radius:10px;background:#fff}
.badge-dot{width:36px;height:36px;border-radius:50%}

  </style>
</head>
<body>
<!-- Header -->
<div class="navbar">
  <div class="nav-left">
    <i class="fas fa-bars nav-icon" onclick="openSidebar()"></i>
    <i class="fas fa-search nav-icon" onclick="window.location.href='search.html'"></i>
  </div>

  <img src="navvy.png" alt="NAVY Logo" class="logo" />

  <div class="nav-right">
    <!-- يظهر إذا المستخدم مو داخل -->
    <a href="login.html" class="nav-link" data-login-link>Login</a>

    <!-- يظهر إذا المستخدم داخل -->
    <button onclick="openProfileMenu()" data-user-button style="background:none;border:none;cursor:pointer;">
      <i class="fas fa-user nav-icon"></i>
      <span data-user-name style="font-size:14px;margin-inline-start:6px;"></span>
    </button>

    <a href="cart.html" style="position: relative;">
      <i class="fas fa-shopping-bag nav-icon"></i>
      <span class="cart-count" id="cart-count">0</span>
    </a>
  </div>
</div> <!-- ← إغلاق navbar -->


  <!-- Navy Points badge (مكانه الجديد بعد الهيدر مباشرة) -->
  <div id="navy-points-badge" style="max-width:420px;margin:12px auto 20px;"></div>

  <!-- Profile Sidebar -->
<div id="profileMenu" style="position:fixed;top:0;right:-100%;width:70%;height:100vh;background:#fff;box-shadow:-2px 0 5px rgba(0,0,0,.2);transition:right .3s;z-index:1001;padding:25px 20px;border-top-left-radius:25px;border-bottom-left-radius:25px;font-size:12px;">
  <button onclick="closeProfileMenu()" style="position:absolute;top:20px;right:20px;background:none;border:none;font-size:22px;cursor:pointer;">×</button>
  <h2 data-account-title style="font-weight:700;color:#001f3f;font-size:20px;margin-bottom:5px;">Your Account</h2>
  <p style="color:#555;margin-bottom:20px;">
    <strong data-user-name></strong>
  </p>
  <div id="authTabs" style="display:none;gap:8px;margin-bottom:24px;">
    <a href="login.html" style="flex:1;text-align:center;background:#001f3f;color:#fff;padding:10px 0;border-radius:30px;text-decoration:none;font-weight:600;font-size:13px;">Sign In</a>
    <a href="signup.html" style="flex:1;text-align:center;color:#001f3f;padding:10px 0;border-radius:30px;border:2px solid #001f3f;text-decoration:none;font-weight:600;font-size:13px;">Join</a>
  </div>

  <div style="display:flex;flex-direction:column;gap:18px;">
    <!-- هذول للحين مو شغالين -->
    <div><div style="font-weight:700;color:#001f3f;">Purchase History</div><div style="color:#666;">Track an order, start a return or exchange</div></div>
    <div><div style="font-weight:700;color:#001f3f;">My List</div><div style="color:#666;">Your saved items</div></div>

    <!-- هذا شغّال: -->
    <a href="./account-settings.html" id="accountSettingsLink" style="display:block;text-decoration:none;">
      <div style="font-weight:700;color:#001f3f;">Account Settings</div>
      <div style="color:#666;">Update info, payment, addresses, email preferences</div>
    </a>
    <a id="signOutAction" href="javascript:void(0)" onclick="logout()" style="display:none;text-decoration:none;">
      <div style="font-weight:700;color:#d00;">Sign Out</div>
      <div style="color:#666;">Log out from your account</div>
    </a>
  </div>
</div>

<div id="sidebarOverlay" onclick="closeSidebar()" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:999;background:rgba(0,0,0,.3);display:none;"></div>
<div id="profileOverlay" onclick="closeProfileMenu()" style="position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:998;background:rgba(0,0,0,.3);display:none;"></div>

  <!-- App Menu Sidebar -->
  <div id="sidebar" class="sidebar" onclick="event.stopPropagation()">
    <a href="javascript:void(0)" class="closebtn" onclick="closeSidebar()">×</a>
    <div class="menu-item" onclick="toggleSubmenu('men')"><span class="menu-title">Men's</span><i id="arrow-men" class="fas fa-chevron-down arrow-icon"></i></div>
    <div id="submenu-men" class="submenu">
      <a href="#">All Men's</a><a href="#">New Arrivals</a><a href="#">T-Shirts & Henleys</a><a href="#">Hoodies & Sweatshirts</a><a href="#">Graphic Tees</a><a href="#">Sweaters</a><a href="#">Polos</a><a href="#">Shirts</a>
    </div>
    <div class="menu-item" onclick="toggleSubmenu('jeans')"><span class="menu-title">Jeans</span><i id="arrow-jeans" class="fas fa-chevron-down arrow-icon"></i></div>
    <div id="submenu-jeans" class="submenu"><a href="#">Skinny</a><a href="#">Straight</a><a href="#">Relaxed</a></div>
    <div class="menu-item" onclick="toggleSubmenu('activewear')"><span class="menu-title">Activewear</span><i id="arrow-activewear" class="fas fa-chevron-down arrow-icon"></i></div>
    <div id="submenu-activewear" class="submenu"><a href="#">Joggers</a><a href="#">Gym Tops</a><a href="#">Sets</a></div>
    <div class="menu-item" onclick="toggleSubmenu('sale')"><span class="menu-title">Sale</span><i id="arrow-sale" class="fas fa-chevron-down arrow-icon"></i></div>
    <div id="submenu-sale" class="submenu"><a href="#">Offers</a><a href="#">Outlet</a></div>
    <div class="menu-item" onclick="toggleSubmenu('purpose')"><span class="menu-title">Purpose</span><i id="arrow-purpose" class="fas fa-chevron-down arrow-icon"></i></div>
    <div id="submenu-purpose" class="submenu"><a href="#">Sustainability</a><a href="#">Our Story</a></div>
    <a href="#">Help</a><a href="#">Privacy & Terms</a><a href="#">About Us</a><a href="contact-us.html" id="contactLink">Contact Us</a>
  </div>

  <!-- Tagline -->
  <div class="tagline">ملابس رجالية أنيقة ومريحة</div>
<!-- ====== Category Circles Row (Top) ====== -->
<section class="cat-row" aria-label="Top categories">
  <a class="cat" href="#">
    <span class="thumb"><img src="https://picsum.photos/200?random=11" alt="Skater Baggy 360"></span>
    <span class="label">Skater Baggy 360</span>
  </a>
  <a class="cat" href="#">
    <span class="thumb"><img src="https://picsum.photos/200?random=12" alt="Tops"></span>
    <span class="label">Tops</span>
  </a>
  <a class="cat" href="#">
    <span class="thumb"><img src="https://picsum.photos/200?random=13" alt="Bottoms"></span>
    <span class="label">Bottoms</span>
  </a>
  <a class="cat" href="#">
    <span class="thumb"><img src="https://picsum.photos/200?random=14" alt="Jackets & Coats"></span>
    <span class="label">Jackets & Coats</span>
  </a>
  <a class="cat" href="#">
    <span class="thumb"><img src="https://picsum.photos/200?random=15" alt="Sweatshirts & Sweatpants"></span>
    <span class="label">Sweatshirts & Sweatpants</span>
  </a>
  <a class="cat" href="#">
    <span class="thumb"><img src="https://picsum.photos/200?random=16" alt="Graphics Shop"></span>
    <span class="label">Graphics Shop</span>
  </a>
</section>

  <!-- ====== New Shop Section (Hollister-like) ====== -->
  <section class="shop">
    <!-- Left Filters -->
    <aside class="filters filter-scroll">
  <h3>Filter</h3>

  <!-- Category -->
  <div class="facet">
  <button class="facet-btn" onclick="toggleFacet(this)">Category <i class="fa fa-plus"></i></button>
  <div class="facet-content">
      <strong>Tops</strong>
      <label><input type="checkbox"> Graphic Tees</label>
      <label><input type="checkbox"> Tees & Tanks</label>
      <label><input type="checkbox"> Polos</label>
      <label><input type="checkbox"> Shirts</label>
      <label><input type="checkbox"> Hoodies & Sweatshirts</label>
      <label><input type="checkbox"> Sweaters</label>

      <strong>Bottoms</strong>
      <label><input type="checkbox"> Jeans</label>
      <label><input type="checkbox"> Pants</label>
      <label><input type="checkbox"> Sweatpants</label>
      <label><input type="checkbox"> Shorts</label>

      <strong>Other</strong>
      <label><input type="checkbox"> Activewear</label>
      <label><input type="checkbox"> Sleepwear</label>
      <label><input type="checkbox"> Jackets & Coats</label>
      <label><input type="checkbox"> Swimwear</label>
      <label><input type="checkbox"> Underwear</label>
      <label><input type="checkbox"> Accessories</label>
      <label><input type="checkbox"> Fragrance</label>
    </div>
  </div>

  <!-- Color -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Color <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> Blue</label>
      <label><input type="checkbox"> Black</label>
      <label><input type="checkbox"> White</label>
      <label><input type="checkbox"> Grey</label>
      <label><input type="checkbox"> Green</label>
      <label><input type="checkbox"> Red</label>
      <label><input type="checkbox"> Pink</label>
      <label><input type="checkbox"> Purple</label>
      <label><input type="checkbox"> Orange</label>
      <label><input type="checkbox"> Multi</label>
      <label><input type="checkbox"> Yellow</label>
    </div>
  </div>

  <!-- Size -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Size <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> XS</label>
      <label><input type="checkbox"> S</label>
      <label><input type="checkbox"> M</label>
      <label><input type="checkbox"> L</label>
      <label><input type="checkbox"> XL</label>
      <label><input type="checkbox"> XXL</label>
      <label><input type="checkbox"> XXXL</label>
      <label><input type="checkbox"> 26</label>
      <label><input type="checkbox"> 28</label>
      <label><input type="checkbox"> 29</label>
      <label><input type="checkbox"> 30</label>
      <label><input type="checkbox"> 31</label>
      <label><input type="checkbox"> 32</label>
      <label><input type="checkbox"> 33</label>
      <label><input type="checkbox"> 34</label>
      <label><input type="checkbox"> 36</label>
      <label><input type="checkbox"> 38</label>
      <label><input type="checkbox"> 40</label>
      <label><input type="checkbox"> 1.7 OZ</label>
      <label><input type="checkbox"> ONE SIZE</label>
    </div>
  </div>

  <!-- Length -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Length <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> 28</label>
      <label><input type="checkbox"> Regular</label>
      <label><input type="checkbox"> Tall</label>
      <label><input type="checkbox"> 30</label>
      <label><input type="checkbox"> 32</label>
      <label><input type="checkbox"> 34</label>
      <label><input type="checkbox"> 36</label>
    </div>
  </div>

  <!-- Style -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Style <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> Baggy</label>
      <label><input type="checkbox"> Jogger</label>
      <label><input type="checkbox"> Super Baggy</label>
      <label><input type="checkbox"> Active Short</label>
      <label><input type="checkbox"> Hoodie</label>
      <label><input type="checkbox"> Loose</label>
      <label><input type="checkbox"> Fleece Short</label>
      <label><input type="checkbox"> Straight Leg</label>
      <label><input type="checkbox"> Slim Straight</label>
      <label><input type="checkbox"> Boot</label>
      <label><input type="checkbox"> Jogger Short</label>
      <label><input type="checkbox"> Skater Baggy</label>
      <label><input type="checkbox"> Straight</label>
      <label><input type="checkbox"> Windbreaker</label>
      <label><input type="checkbox"> Button-Up Shirt</label>
      <label><input type="checkbox"> Athletic Skinny</label>
      <label><input type="checkbox"> Linen</label>
      <label><input type="checkbox"> Skinny</label>
      <label><input type="checkbox"> Puffer</label>
      <label><input type="checkbox"> Jacket</label>
      <label><input type="checkbox"> Pullover</label>
      <label><input type="checkbox"> Crewneck</label>
      <label><input type="checkbox"> Crewneck T-Shirt</label>
      <label><input type="checkbox"> Relaxed Denim Short</label>
      <label><input type="checkbox"> Boxer Brief</label>
      <label><input type="checkbox"> Super Skinny</label>
      <label><input type="checkbox"> Big Jeans</label>
      <label><input type="checkbox"> Flat-Front Short</label>
      <label><input type="checkbox"> Taper</label>
      <label><input type="checkbox"> Guard Swim Trunk</label>
      <label><input type="checkbox"> Zip-Up</label>
      <label><input type="checkbox"> Ankle Socks</label>
      <label><input type="checkbox"> Bomber</label>
      <label><input type="checkbox"> Denim Jacket</label>
      <label><input type="checkbox"> Henley</label>
      <label><input type="checkbox"> Vest</label>
      <label><input type="checkbox"> Beanie</label>
      <label><input type="checkbox"> Belt</label>
      <label><input type="checkbox"> Boxer Short</label>
      <label><input type="checkbox"> Cardigan</label>
      <label><input type="checkbox"> Half Pant</label>
      <label><input type="checkbox"> Sport Boxer Brief</label>
    </div>
  </div>

  <!-- Material -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Material <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> Fleece</label>
      <label><input type="checkbox"> Pique</label>
      <label><input type="checkbox"> Cotton Blend</label>
      <label><input type="checkbox"> Linen Blend</label>
      <label><input type="checkbox"> Poplin</label>
      <label><input type="checkbox"> Leather</label>
      <label><input type="checkbox"> Flannel</label>
      <label><input type="checkbox"> Oxford</label>
      <label><input type="checkbox"> Ribbed</label>
      <label><input type="checkbox"> Wool</label>
    </div>
  </div>

  <!-- Length Style -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Length Style <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> Full-Length</label>
      <label><input type="checkbox"> Mid-Thigh</label>
      <label><input type="checkbox"> Longer-Length</label>
      <label><input type="checkbox"> Classic-Length</label>
      <label><input type="checkbox"> Above the Knee</label>
      <label><input type="checkbox"> At the Knee</label>
      <label><input type="checkbox"> Below the Knee</label>
    </div>
  </div>

  <!-- Details -->
  <div class="facet">
    <button class="facet-btn" onclick="toggleFacet(this)">Details <i class="fa fa-plus"></i></button>
    <div class="facet-content">
      <label><input type="checkbox"> Pull-On Waistband</label>
      <label><input type="checkbox"> Pockets</label>
      <label><input type="checkbox"> Zipper Pocket</label>
      <label><input type="checkbox"> Phone Pocket</label>
      <label><input type="checkbox"> Earth-Friendly</label>
      <label><input type="checkbox"> Stretch</label>
    </div>
  </div>

</aside>


    <!-- Main content -->
    <main>
      <div class="sort-row">
        <span>Sort By</span>
        <select>
          <option>Featured</option>
          <option>Price: Low to High</option>
          <option>Price: High to Low</option>
          <option>Newest</option>
        </select>
      </div>

      <div class="grid" id="productsGrid">
        <!-- Promo Banner -->
        <a class="promo" href="#">
          <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=1200&auto=format&fit=crop" alt="Promo">
          <div class="promo-text">30% Off<br/>Select Styles</div>
        </a>

        <!-- Product 1 -->
        <div class="product">
          <button class="wish"><i class="fa-regular fa-heart"></i></button>
          <img src="https://picsum.photos/600/700?random=1" alt="Product 1">
          <div class="swatches">
            <span class="swatch" style="background:#000"></span>
            <span class="swatch" style="background:#888"></span>
            <span class="swatch" style="background:#b3c7ff"></span>
            <span class="swatch more">+4</span>
          </div>
          <h2>تيشيرت أبيض</h2>
          <div class="price">KD 7.000</div>
        </div>

        <!-- Product 2 -->
        <div class="product">
          <button class="wish"><i class="fa-regular fa-heart"></i></button>
          <img src="https://picsum.photos/600/700?random=2" alt="Product 2">
          <div class="swatches">
            <span class="swatch" style="background:#d1d1d1"></span>
            <span class="swatch" style="background:#9e9e9e"></span>
            <span class="swatch more">+7</span>
          </div>
          <h2>شورت صيفي</h2>
          <div class="price">KD 5.500</div>
        </div>

        <!-- Product 3 -->
        <div class="product">
          <button class="wish"><i class="fa-regular fa-heart"></i></button>
          <img src="https://picsum.photos/600/700?random=3" alt="Product 3">
          <div class="swatches">
            <span class="swatch" style="background:#2b2b2b"></span>
            <span class="swatch" style="background:#5b5b5b"></span>
            <span class="swatch more">+4</span>
          </div>
          <h2>بنطلون رياضي</h2>
          <div class="price">KD 8.000</div>
        </div>
      </div>
    </main>
  </section>

  <!-- Footer (كما هو في نسختك) -->
  <footer style="background-color:#f8f6f3;font-family:'Barlow',sans-serif;color:#333;font-size:14px;">
    <div style="max-width:1200px;margin:auto;padding:60px 20px;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:flex-start;gap:40px;">
      <div style="flex:1;min-width:180px;">
        <h4 style="color:#2c2c2c;font-weight:700;">About Us</h4>
        <p style="color:#666;">Brand Protection</p><p style="color:#666;">Careers</p><p style="color:#666;">Accessibility</p>
        <p style="color:#666;">Inclusion & Diversity</p><p style="color:#666;">Press Room</p><p style="color:#666;">Sustainability</p>
      </div>
      <div style="flex:1;min-width:180px;">
        <h4 style="color:#2c2c2c;font-weight:700;">Help</h4>
        <p style="color:#666;">Customer Help</p><p style="color:#666;">Order Help</p><p style="color:#666;">Shipping & Handling</p>
        <p style="color:#666;">Online Returns</p><p style="color:#666;">Track My Order</p><p style="color:#666;">Cards & E-Cards</p>
      </div>
      <div style="flex:1;min-width:180px;">
        <h4 style="color:transparent;margin-bottom:15px;">‎</h4>
        <p style="color:#000;">🇰🇼 <a href="#" style="color:#000;text-decoration:underline;">Kuwait</a></p>
      </div>
      <div style="flex:1;min-width:250px;">
        <h4 style="color:#2c2c2c;font-weight:700;">Subscribe</h4>
        <input type="email" placeholder="Email Address" style="width:100%;padding:12px 0;border:none;border-bottom:2px solid #333;background:transparent;margin-bottom:15px;color:#000;">
        <button style="width:100%;background:#2c2c2c;color:#fff;padding:12px 0;border:none;border-radius:50px;font-weight:700;">Join</button>
        <div style="margin-top:30px;display:flex;justify-content:space-between;align-items:center;max-width:240px;">
          <i class="fab fa-tiktok" style="color:#777;font-size:20px;"></i>
          <a href="https://www.instagram.com/try.navy" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-instagram" style="color:#777;font-size:20px;"></i>
          </a>
          <i class="fab fa-facebook-f" style="color:#777;font-size:20px;"></i>
          <i class="fab fa-youtube" style="color:#777;font-size:20px;"></i>
        </div>
      </div>
    </div>
    <div style="text-align:center;padding:20px 0;background:#eee;font-size:13px;">
      2025 © NAVY. All rights reserved. &nbsp; | &nbsp; <a href="#" style="color:#333;">trynavy.com</a>
    </div>
  </footer>

  <script>
  // Sidebar + overlays
  function openSidebar(){document.getElementById("sidebar").style.width="70%";document.getElementById("sidebarOverlay").style.display="block";}
  function closeSidebar(){document.getElementById("sidebar").style.width="0";document.getElementById("sidebarOverlay").style.display="none";}
  function openProfileMenu(){document.getElementById("profileMenu").style.right="0";document.getElementById("profileOverlay").style.display="block";}
  function closeProfileMenu(){document.getElementById("profileMenu").style.right="-100%";document.getElementById("profileOverlay").style.display="none";}

  // Cart count
  function updateCartCount(){
    let cart=JSON.parse(localStorage.getItem('cart'))||[];
    let total=cart.reduce((s,i)=>s+(i.qty||1),0);
    const el = document.getElementById('cart-count');
    if(el) el.textContent=total;
  }
  updateCartCount();

  // Sidebar submenus
  function toggleSubmenu(id){
    const s=document.getElementById(`submenu-${id}`);
    const a=document.getElementById(`arrow-${id}`);
    if(!s||!a) return;
    const open = s.style.display==="block";
    s.style.display = open?"none":"block";
    a.classList.toggle("rotate", !open);
  }

  // Left filters accordion
  function toggleFacet(btn){
    const box = btn.parentElement.querySelector('.facet-content');
    const icon = btn.querySelector('i');
    const open = box.style.display === 'block';
    box.style.display = open ? 'none' : 'block';
    icon.className = open ? 'fa fa-plus' : 'fa fa-minus';
  }

  // Drag scroll for categories row
  (function(){
    const row = document.querySelector('.cat-row');
    if(!row) return;
    let isDown=false, startX=0, scrollLeft=0;
    row.addEventListener('mousedown', e=>{
      isDown=true; row.classList.add('dragging');
      startX = e.pageX - row.offsetLeft;
      scrollLeft = row.scrollLeft;
    });
    ['mouseleave','mouseup'].forEach(ev=>{
      row.addEventListener(ev, ()=>{ isDown=false; row.classList.remove('dragging'); });
    });
    row.addEventListener('mousemove', e=>{
      if(!isDown) return;
      e.preventDefault();
      const x = e.pageX - row.offsetLeft;
      const walk = (x - startX);
      row.scrollLeft = scrollLeft - walk;
    });
  })();

  // Smooth close then go to Contact Us
  (function(){
    const contact = document.getElementById('contactLink');
    if(!contact) return;
    contact.addEventListener('click', function (e) {
      e.preventDefault();
      try { closeSidebar(); } catch(e){}
      setTimeout(()=>{ window.location.href = 'contact-us.html'; }, 280);
    });
  })();

  // Close profile panel before going to account settings
  (function(){
    const link = document.getElementById('accountSettingsLink');
    if(!link) return;
    link.addEventListener('click', function () {
      try { closeProfileMenu(); } catch(e) {}
    });
  })();
</script>

<!-- لازم يكون قبل استخدام Loyalty -->
<script src="loyalty.js"></script>
<script>
  function getAuthUser(){
    if (window.NAVY_AUTH && typeof window.NAVY_AUTH.getLoggedInUser === 'function'){
      return window.NAVY_AUTH.getLoggedInUser() || null;
    }
    // fallback من localStorage
    const email = localStorage.getItem('userEmail');
    const name  = localStorage.getItem('userName');
    const phone = localStorage.getItem('userPhone');
    const phoneCode = localStorage.getItem('userPhoneCode') || '';
    if (email) return { email, name, profile: { phoneCode, phone } };
    return null;
  }

  function updateAuthUI(){
    const user = getAuthUser();
    const loggedIn = !!(user && user.email);

    const loginLink   = document.querySelector('[data-login-link]');
    const userBtn     = document.querySelector('[data-user-button]');
    const nameSlots   = document.querySelectorAll('[data-user-name]');
    const accountTitle= document.querySelector('[data-account-title]');
    const authTabs    = document.getElementById('authTabs');
    const signOutLink = document.getElementById('signOutAction');

    if (loginLink)   loginLink.style.display   = loggedIn ? 'none' : 'inline-block';
    if (userBtn)     userBtn.style.display     = loggedIn ? 'inline-flex' : 'none';
    if (authTabs)    authTabs.style.display    = loggedIn ? 'none' : 'flex';
    if (signOutLink) signOutLink.style.display = loggedIn ? 'block' : 'none';

    nameSlots.forEach(el => {
      el.textContent = loggedIn ? (user.name || (user.email||'').split('@')[0]) : 'Guest';
    });
    if (accountTitle) accountTitle.textContent = loggedIn ? 'Your Account' : 'Welcome';

    // حدث البادج حسب المستخدم الحالي
    try{
      const email = loggedIn ? user.email : 'guest@example.com';
      const phone = (user?.profile?.phoneCode || '') + (user?.profile?.phone || '') || '00000000';
      const customer = Loyalty.getOrCreateCustomer({ email, phone });
      const t = Loyalty.getTier(customer.points);
      const el = document.getElementById('navy-points-badge');
      if (el){
        el.innerHTML = `
          <div style="display:flex;align-items:center;gap:10px;padding:12px;border:1px solid #e7e3dc;border-radius:10px;background:#fff;">
            <div style="width:36px;height:36px;border-radius:50%;background:${t.color};"></div>
            <div style="line-height:1.25">
              <div style="font-weight:600;">Navy Points • ${t.name}</div>
              <div style="font-size:12px;color:#6b6b6b;">${customer.points} pts • ${t.discountPct}% off on preferred sizes</div>
            </div>
          </div>
        `;
      }
    }catch(e){}
  }

  // Logout متكامل
  function logout(){
    try { if (window.NAVY_AUTH?.logout) window.NAVY_AUTH.logout(); } catch(e){}
    localStorage.removeItem('userEmail');
    localStorage.removeItem('userName');
    localStorage.removeItem('userPhone');
    localStorage.removeItem('userPhoneCode');
    try { closeProfileMenu(); } catch(e){}
    window.dispatchEvent(new Event('navy:auth-changed'));
    updateAuthUI();
  }
  window.logout = logout;

  document.addEventListener('DOMContentLoaded', updateAuthUI);
  window.addEventListener('navy:auth-changed', updateAuthUI);
</script>

<script>
  // بيانات المستخدم (عدّل لو عندك مفاتيح مختلفة)
  const authUser = (window.NAVY_AUTH && window.NAVY_AUTH.getLoggedInUser)
  ? (window.NAVY_AUTH.getLoggedInUser() || {})
  : {};
const userEmail = authUser.email || 'guest@example.com';
const phoneFromProfile = authUser.profile && (authUser.profile.phoneCode || '') + (authUser.profile.phone || '');
const userPhone = (authUser.phone || phoneFromProfile || '').trim() || '00000000';

const customer = Loyalty.getOrCreateCustomer({ email: userEmail, phone: userPhone });


  // رسم البادج
  (function renderBadge() {
    const t = Loyalty.getTier(customer.points);
    const el = document.getElementById('navy-points-badge');
    if (!el) return;
    el.innerHTML = `
      <div style="display:flex;align-items:center;gap:10px;padding:12px;border:1px solid #e7e3dc;border-radius:10px;background:#fff;">
        <div style="width:36px;height:36px;border-radius:50%;background:${t.color};"></div>
        <div style="line-height:1.25">
          <div style="font-weight:600;">Navy Points • ${t.name}</div>
          <div style="font-size:12px;color:#6b6b6b;">${customer.points} pts • ${t.discountPct}% off on preferred sizes</div>
        </div>
      </div>
    `;
  })();
</script>
<div id="pdpOverlay" class="pdp-overlay" onclick="closePDP()"></div>
<div id="pdp" class="pdp" onclick="event.stopPropagation()">
  <div class="pdp-hd">
    <div style="font-weight:800;color:#001f3f">NAVY</div>
    <button onclick="closePDP()" style="background:none;border:0;font-size:22px;cursor:pointer">×</button>
  </div>

  <div class="pdp-body">
    <div class="pdp-gallery" id="pdpGallery"></div>

    <div>
      <h1 class="pdp-title" id="pdpTitle"></h1>
      <div class="pdp-price" id="pdpPrice"></div>

      <div class="badge" id="loyaltyBadge" style="margin:6px 0 14px;">
        <div class="badge-dot" id="badgeDot"></div>
        <div style="line-height:1.2">
          <div style="font-weight:700">Navy Points</div>
          <div id="badgeText" style="font-size:12px;color:#6b6b6b"></div>
        </div>
      </div>

      <div class="section-hd">Color</div>
      <div class="color-row" id="pdpColors"></div>

      <div class="section-hd" style="display:flex;align-items:center;gap:8px">
        Size <span id="sizeHint" style="font-weight:400;color:#6b6b6b;font-size:13px"></span>
      </div>
      <div class="size-row" id="pdpSizes"></div>

      <div class="pdp-actions">
        <button class="btn-pill btn-primary" id="addToBagBtn">Add to Bag</button>
        <button class="btn-pill btn-ghost" id="saveBtn"><i class="fa-regular fa-heart"></i>&nbsp;Save</button>
      </div>

      <div class="pdp-meta">
        <div class="meta-item"><span>Details & Material</span><i class="fa fa-plus"></i></div>
        <div class="meta-item"><span>Size & Fit</span><i class="fa fa-plus"></i></div>
        <div class="meta-item"><span>Shipping & Returns</span><i class="fa fa-plus"></i></div>
      </div>
    </div>
  </div>
</div>

<script src="auth.js"></script>
<script>
  const PRODUCTS = [
  {
    id:'shorts-hybrid',
    name:'Mid-Thigh Hybrid Active Shorts',
    price: 12.534,
    images: [
      'https://picsum.photos/700/800?random=101',
      'https://picsum.photos/700/800?random=102',
      'https://picsum.photos/700/800?random=103'
    ],
    colors: [
      {code:'#0b0b0b', name:'Black', imagesIndex:[0,1,2]},
      {code:'#6b7280', name:'Grey',  imagesIndex:[0,2,1]},
      {code:'#e5e7eb', name:'White', imagesIndex:[2,1,0]},
      {code:'#1f2937', name:'Navy',  imagesIndex:[1,0,2]}
    ],
    sizes:['XS','S','M','L','XL','XXL'],
    url:'index.html#shorts-hybrid'
  },
  {
  id:'classic-hoodie',
  name:'Classic Navy Hoodie',
  price: 18.750,
  images:[
    'img/products/hoodie1.jpg',
    'img/products/hoodie1.jpg'
  ],
  colors:[
    {code:'#001f3f', name:'Navy', imagesIndex:[0,1]},
    {code:'#111827', name:'Black', imagesIndex:[0,1]}
  ],
  sizes:['S','M','L','XL','XXL'],
  url:'index.html#classic-hoodie'
},
  {
    id:'tee-boxy',
    name:'Boxy Heavyweight Cotton Crew T‑Shirt',
    price: 7.834,
    images: [
      'https://picsum.photos/700/800?random=201',
      'https://picsum.photos/700/800?random=202'
    ],
    colors: [
      {code:'#ffffff', name:'White',  imagesIndex:[0,1]},
      {code:'#111827', name:'Black',  imagesIndex:[1,0]},
      {code:'#cbd5e1', name:'Silver', imagesIndex:[0,1]}
    ],
    sizes:['XS','S','M','L','XL','XXL','XXXL'],
    url:'index.html#tee-boxy'
  },
  {
    id:'sweat-baggy',
    name:'Baggy Sweatpants',
    price: 14.104,
    images: [
      'https://picsum.photos/700/800?random=301',
      'https://picsum.photos/700/800?random=302'
    ],
    colors: [
      {code:'#111827',name:'Black',imagesIndex:[0,1]},
      {code:'#374151',name:'Charcoal',imagesIndex:[1,0]}
    ],
    sizes:['S','M','L','XL'],
    url:'index.html#sweat-baggy'
  }
];

/* ---------- رندر شبكة المنتجات ---------- */
const gridEl = document.getElementById('productsGrid');
function cardHTML(p){
  // swatches صغيرة مثل الهوم
  const sw = p.colors.slice(0,3).map(c=>`<span class="swatch" style="background:${c.code}"></span>`).join('') +
             (p.colors.length>3?`<span class="swatch more">+${p.colors.length-3}</span>`:'');
  // أول صورة
  const cover = p.images[0];
  return `
    <div class="product">
      <button class="wish"><i class="fa-regular fa-heart"></i></button>
      <img src="${cover}" alt="${p.name}">
      <div class="swatches">${sw}</div>
      <h2>${p.name}</h2>
      <div class="price">KD ${p.price.toFixed(3)}</div>
      <button class="btn-pill btn-ghost" onclick="openPDP('${p.id}')">View</button>
    </div>
  `;
}
gridEl.innerHTML =
  (gridEl.querySelector('.promo') ? gridEl.innerHTML : '') +
  PRODUCTS.map(cardHTML).join('');

/* ---------- PDP Logic ---------- */
let currentProduct = null;
let selectedColorIndex = 0;
let selectedSize = '';

const pdpEl = document.getElementById('pdp');
const pdpOverlay = document.getElementById('pdpOverlay');

function openPDP(id){
  currentProduct = PRODUCTS.find(p=>p.id===id);
  if(!currentProduct) return;

  // عنوان + سعر
  document.getElementById('pdpTitle').textContent = currentProduct.name;
  document.getElementById('pdpPrice').textContent = 'KD ' + currentProduct.price.toFixed(3);

  // Loyalty badge (يقرأ من loyalty.js)
  try{
    const userEmail = localStorage.getItem('userEmail') || 'guest@example.com';
    const userPhone = localStorage.getItem('userPhone') || '00000000';
    const customer = Loyalty.getOrCreateCustomer({ email:userEmail, phone:userPhone });
    const t = Loyalty.getTier(customer.points);
    document.getElementById('badgeDot').style.background = t.color;
    document.getElementById('badgeText').textContent = `${customer.points} pts • ${t.discountPct}% off on preferred sizes`;
  }catch(e){}

  // صور حسب اللون الأول
  selectedColorIndex = 0;
  renderGalleryForColor(0);

  // الألوان
  const colorsWrap = document.getElementById('pdpColors');
  colorsWrap.innerHTML = currentProduct.colors.map((c,i)=>(
    `<button class="swatch-lg ${i===0?'active':''}" style="background:${c.code}" aria-label="${c.name}" onclick="selectColor(${i})"></button>`
  )).join('');

  // المقاسات
  const sizesWrap = document.getElementById('pdpSizes');
  sizesWrap.innerHTML = currentProduct.sizes.map(s=>(
    `<button class="size-chip" data-size="${s}" onclick="selectSize('${s}', this)">${s}</button>`
  )).join('');
  selectedSize = '';
  document.getElementById('sizeHint').textContent = '(Select size)';

  // أزرار
  document.getElementById('addToBagBtn').onclick = addToBag;

  // فتح
  pdpOverlay.style.display = 'block';
  requestAnimationFrame(()=>{ pdpEl.style.right = '0'; });
}
function closePDP(){
  pdpEl.style.right = '-100%';
  setTimeout(()=>{ pdpOverlay.style.display='none'; }, 280);
}
function renderGalleryForColor(colorIdx){
  const idxs = currentProduct.colors[colorIdx].imagesIndex || [0];
  const imgs = idxs.map(i=>currentProduct.images[i]);
  document.getElementById('pdpGallery').innerHTML = imgs.map(src=>`<img src="${src}">`).join('');
}
function selectColor(i){
  selectedColorIndex = i;
  renderGalleryForColor(i);
  document.querySelectorAll('#pdpColors .swatch-lg').forEach((b,idx)=>b.classList.toggle('active', idx===i));
}
function selectSize(s, btn){
  selectedSize = s;
  document.querySelectorAll('#pdpSizes .size-chip').forEach(el=>el.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('sizeHint').textContent = `(Selected: ${s})`;
}

/* ---------- Add to Bag ---------- */
function addToBag(){
  if(!currentProduct){ return; }
  if(!selectedSize){
    alert('Select a size first'); return;
  }
  const color = currentProduct.colors[selectedColorIndex]?.name || '';
  const image = currentProduct.images[ (currentProduct.colors[selectedColorIndex]?.imagesIndex||[0])[0] ] || currentProduct.images[0];

  const line = {
    sku: currentProduct.id,
    name: currentProduct.name,
    price: currentProduct.price,
    size: selectedSize,
    color: color,
    image: image,
    qty: 1,
    productUrl: currentProduct.url
  };

  const cart = JSON.parse(localStorage.getItem('cart')||'[]');
  cart.push(line);
  localStorage.setItem('cart', JSON.stringify(cart));

  // حدّث عدّاد السلة
  updateCartCount?.();

  // نقاط ولاء منطقية بعد الشراء – هنا نقدر نراكم «نية طلب» لو حاب
  try {
    const userEmail = localStorage.getItem('userEmail') || 'guest@example.com';
    const userPhone = localStorage.getItem('userPhone') || '00000000';
    const customer = Loyalty.getOrCreateCustomer({ email:userEmail, phone:userPhone });
    // لا نضيف نقاط الآن (تُضاف بعد الدفع)، فقط نحدّث تفضيلات المقاسات:
    Loyalty.accruePoints(customer, 0, [{ size: selectedSize, qty:1 }]);
  } catch(e){}

  // نفس سلوك هولستر: إشعار سريع
  closePDP();
  toast('Added to Bag');
}

/* ---------- Toast بسيط ---------- */
function toast(msg){
  const t=document.createElement('div');
  t.textContent=msg;
  t.style.cssText='position:fixed;bottom:22px;left:50%;transform:translateX(-50%);background:#001f3f;color:#fff;padding:10px 14px;border-radius:999px;font-weight:800;z-index:2000';
  document.body.appendChild(t);
  setTimeout(()=>t.remove(),1300);
}
  // === تخزين حالة الدخول يتم بعد نجاح اللوق-إن في login.html مثلا ===
  // مثال: localStorage.setItem('navy_token', '1');
  //       localStorage.setItem('navy_user', JSON.stringify({ fullName:'Abdullah Alkhudair', email:'you@x.com' }));

  function isLoggedIn(){ return !!localStorage.getItem('navy_token'); }
  function getUser(){
    try { return JSON.parse(localStorage.getItem('navy_user')||'null'); }
    catch { return null; }
  }

  function refreshAuthUI(){
    const logged = isLoggedIn();
    const user = getUser();

    // navbar
    const loginLink   = document.querySelector('[data-login-link]');
    const userBtn     = document.querySelector('[data-user-button]');
    const userNameNav = document.querySelector('.nav-right [data-user-name]');

    if (loginLink) loginLink.style.display = logged ? 'none' : 'inline-block';
    if (userBtn)   userBtn.style.display   = 'inline-flex'; // دايمًا ظاهر
    if (userNameNav) userNameNav.textContent = logged && user?.fullName ? user.fullName.split(' ')[0] : '';

    // داخل لوحة الحساب (البانِل)
    const authTabs     = document.getElementById('authTabs');        // أزرار Sign In/Join
    const nameInPanel  = document.querySelector('#profileMenu [data-user-name]');
    const titleInPanel = document.querySelector('[data-account-title]');
    const signOut = document.getElementById('signOutAction');
    const accLink = document.getElementById('accountSettingsLink');

    if (accLink) accLink.style.display = logged ? 'block' : 'none';
    if (authTabs)    authTabs.style.display = logged ? 'none' : 'flex';
    if (titleInPanel) titleInPanel.textContent = logged ? 'Your Account' : 'Welcome';
    if (nameInPanel) nameInPanel.textContent  = logged ? (user?.fullName || '') : 'Guest';
    if (signOut) signOut.style.display = logged ? 'block' : 'none';
  }

  // لما تفتح لوحة الحساب حدّثها
  const _openProfileMenu = openProfileMenu;
  window.openProfileMenu = function(){
    _openProfileMenu(); // يستدعي القديمة
    refreshAuthUI();
  };

  // عند تحميل الصفحة
  document.addEventListener('DOMContentLoaded', refreshAuthUI);

  // (اختياري) زر لوج آوت لو بتحطه مستقبلاً:
  window.logout = function(){
    localStorage.removeItem('navy_token');
    localStorage.removeItem('navy_user');
    refreshAuthUI();
    closeProfileMenu();
  };

  // API معرّف مستخدم بسيط بديل
function fakeAuth(email, password){
    // تقدر تغيّر الشرط على مزاجك ، أو تعمل بيانك إذا حقيقي
    return email && password.length >= 3;
}

document.addEventListener('DOMContentLoaded', function(){
    const form  = document.getElementById('loginForm');
    const email = document.getElementById('emailInput');
    const pass  = document.getElementById('passwordInput');
    const error = document.getElementById('loginError');

    if(!form) return;

    form.addEventListener('submit', function(e){
        e.preventDefault();  // مهم: لا يخلي الصفحة تعيد تحميل نفسها
        error.textContent = ''; // تصفير الأخطاء

        const em = (email.value || '').trim();
        const pw = pass.value || '';

        if(!em || !pw){
            error.textContent = 'الرجاء إدخال الإيميل وكلمة المرور';
            return;
        }

        if(!fakeAuth(em, pw)){
            error.textContent = 'بيانات الدخول غير صحيحة';
            return;
        }

        // حفظ حالة الدخول
        localStorage.setItem('navy_token', '1');
        localStorage.setItem('navy_user', JSON.stringify({
            fullName: 'Abdullah Alkhudair',
            email: em
        }));

        // رجع المستخدم للرئيسية
        window.location.href = 'index.html';
    });
}); // ← هنا سكرت الحدث بالكامل

</script>

</body>
</html>